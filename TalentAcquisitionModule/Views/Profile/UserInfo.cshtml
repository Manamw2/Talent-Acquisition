@model ProfileInfoVM
@{
    ViewData["Title"] = "Update Profile";
    Layout = "_profileLayout";
}

<div class="container d-flex justify-content-center align-items-center" style="min-height: 80vh;">
    <div class="row justify-content-center w-100">
        <div class="col-md-10">
            <!-- Card Container -->
            <div class="card shadow-lg border-0 rounded-3 p-4 mx-auto" style="max-width: 800px;">
                <!-- Registration Section -->
                <div class="mb-3">
                    <h5 class="fw-bold">Basic Information Section</h5>
                    <!-- Registration Form -->
                    <form enctype="multipart/form-data" method="post">
                        <div asp-validation-summary="All" class="text-danger"></div>
                        <!-- Email -->
                        <div class="mb-3">
                            <label for="Email" class="form-label fw-semibold">
                                Email Address: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-envelope"></i></span>
                                <input asp-for="Email" class="form-control form-control-lg" id="email" placeholder="Enter your email" required>
                            </div>
                            <span asp-validation-for="Email" class="text-danger"></span>
                        </div>

                        <!-- Name -->
                        <div class="mb-3">
                            <label for="Name" class="form-label fw-semibold">
                                Name: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-person"></i></span>
                                <input asp-for="Name" class="form-control form-control-lg" id="name" placeholder="Enter your name" required>
                            </div>
                            <span asp-validation-for="Name" class="text-danger"></span>
                        </div>

                        <!-- Phone Number -->
                        <div class="mb-3">
                            <label for="Phone" class="form-label fw-semibold">
                                Phone Number: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-phone"></i></span>
                                <input asp-for="Phone" class="form-control form-control-lg" id="phone" placeholder="Enter your phone number" required>
                            </div>
                            <span asp-validation-for="Phone" class="text-danger"></span>
                        </div>

                        <!-- university Dropdown -->
                        <div class="mb-3">
                            <label for="universityInput" class="form-label fw-semibold">
                                University: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-book"></i></span>
                                <select asp-for="University" asp-items="ViewBag.Universities" class="form-control form-control-lg" id="educationLevel" required>
                                    <option value="">Select your university</option>
                                </select>
                            </div>
                            <span asp-validation-for="University" class="text-danger"></span>
                        </div>

                        <!-- Faculty Dropdown -->
                        <div class="mb-3">
                            <label for="facultyInput" class="form-label fw-semibold">
                                Faculty: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-book"></i></span>
                                <select asp-for="Faculty" asp-items="ViewBag.Faculties" class="form-control form-control-lg" id="educationLevel" required>
                                    <option value="">Select your faculty</option>
                                </select>
                            </div>
                            <span asp-validation-for="Faculty" class="text-danger"></span>
                        </div>


                        <!-- Date of Birth -->
                        <div class="mb-3">
                            <label for="DateOfBirth" class="form-label fw-semibold">
                                Date of Birth: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-calendar"></i></span>
                                <input asp-for="DateOfBirth" type="date" class="form-control form-control-lg" id="dateOfBirth" asp-value="" required>
                            </div>
                            <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                        </div>

                        <!-- Education Level -->
                        <div class="mb-3">
                            <label for="EducationLevel" class="form-label fw-semibold">
                                Education Level: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-book"></i></span>
                                <select asp-for="EducationLevel" asp-items="Model.Input.EducationLevels" class="form-control form-control-lg" id="educationLevel" required>
                                    <option value="">Select education level</option>
                                </select>
                            </div>
                            <span asp-validation-for="EducationLevel" class="text-danger"></span>
                        </div>

                        <!-- English Proficiency Level -->
                        <div class="mb-3">
                            <label for="EnglishProficiencyLevel" class="form-label fw-semibold">
                                English Proficiency Level: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-translate"></i></span>
                                <select asp-for="EnglishProficiencyLevel" asp-items="Model.Input.EnglishProficiencyLevels" class="form-control form-control-lg" id="englishProficiency" required>
                                    <option value="">Select English proficiency level</option>
                                </select>
                            </div>
                            <span asp-validation-for="EnglishProficiencyLevel" class="text-danger"></span>
                        </div>

                        <!-- Method of Contact -->
                        <div class="mb-3">
                            <label for="MethodOfContact" class="form-label fw-semibold">
                                Method of Contact: <span class="text-danger">*</span>
                            </label>
                            <div class="input-group">
                                <span class="input-group-text bg-danger text-white"><i class="bi bi-telephone"></i></span>
                                <select asp-for="MethodOfContact" asp-items="Model.Input.MethodOfContactOptions" class="form-control form-control-lg" id="methodOfContact" required>
                                    <option value="">Select preferred method of contact</option>
                                </select>
                            </div>
                            <span asp-validation-for="MethodOfContact" class="text-danger"></span>
                        </div>

                        <!-- CV Upload -->
                        <div class="row">
                            <div class="mb-3">
                                <label for="cvFile" class="form-label fw-semibold">
                                    Upload CV: <span class="text-danger">*</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text bg-danger text-white"><i class="bi bi-file-earmark-arrow-up"></i></span>
                                    <input asp-for="CvFile" type="file" class="form-control form-control-lg" id="cvFile">
                                    <a href="@Url.Action("DownloadCv", "Profile", new { filePath = Model.CvUrl, fileName = Model.Name + ".pdf" })"
                                       class="btn btn-danger ms-2 d-flex align-items-center justify-content-center"
                                       style="min-width: 120px;">
                                        Download CV
                                    </a>
                                </div>
                                <span asp-validation-for="CvFile" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Profile Completion Section -->
                        <h5 class="fw-bold mt-5 mb-3">Professional Information Section</h5>

                        <!-- Work Experience Section -->
                        <div class="mb-4">
                            <p class="mb-4 fs-5">Professional journey</p>

                            <div id="experiencesContainer">
                                @for (var i = 0; i < Model.Experiences.Count; i++)
                                {
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <button type="button" class="btn btn-outline-secondary toggle-experience">
                                                    <span class="chevron-icon">▼</span>
                                                    Experience @(i + 1)
                                                </button>
                                                <button type="button" class="btn-close remove-experience" aria-label="Close"></button>
                                            </div>
                                            <div class="collapsible-content show">
                                                <input type="hidden" asp-for="Experiences[i].Id" />
                                                <div class="mb-3">
                                                    <input type="text" class="form-control" asp-for="Experiences[i].Company" placeholder="Company" required/>
                                                </div>
                                                <div class="mb-3">
                                                    <input type="text" class="form-control" asp-for="Experiences[i].Position" placeholder="Position" required />
                                                </div>
                                                <div class="row mb-3">
                                                    <div class="col-md-6">
                                                        <input type="date" class="form-control" asp-for="Experiences[i].StartDate"/>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <input type="date" class="form-control" asp-for="Experiences[i].EndDate"/>
                                                    </div>
                                                </div>
                                                <div class="mb-3">
                                                    <textarea class="form-control" asp-for="Experiences[i].Description" rows="3" placeholder="Description" required></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                            <button type="button" id="addExperience" class="btn btn-outline-secondary w-100">
                                + Add Experience
                            </button>
                        </div>

                        <!-- Skills Section -->
                        <div class="mb-4 ">
                            <p class="fs-5 mb-4">Technical and professional skills</p>

                            <div id="skillsContainer">
                                @for (var index = 0; index < Model.Skills.Count; index++)
                                {
                                    <div class="row mb-3">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <button type="button" class="btn btn-outline-secondary toggle-skill">
                                                <span class="chevron-icon">▼</span>
                                                Skill @(index + 1)
                                            </button>
                                            <button type="button" class="btn-close remove-skill" aria-label="Close"></button>
                                        </div>
                                        <div class="collapsible-content show">
                                            <input type="hidden" asp-for="Skills[index].Id" />
                                            <div class="row">
                                                <div class="col-md-8">
                                                    <input type="text" class="form-control" asp-for="Skills[index].Name" placeholder="Skill name" required/>
                                                </div>
                                                <div class="col-md-4">
                                                    <select class="form-control" asp-for="Skills[index].Level" required>
                                                        <option value="Beginner">Beginner</option>
                                                        <option value="Intermediate">Intermediate</option>
                                                        <option value="Advanced">Advanced</option>
                                                        <option value="Expert">Expert</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                            <button type="button" id="addSkill" class="btn btn-outline-secondary w-100">
                                + Add Skill
                            </button>
                        </div>

                        <!-- Projects Section -->
                        <div class="mb-4">
                            <p class="fs-5 mb-4">Best work and achievements</p>

                            <div id="projectsContainer">
                                @for (var i = 0; i < Model.Projects.Count; i++)
                                {
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <button type="button" class="btn btn-outline-secondary toggle-project">
                                                    <span class="chevron-icon">▼</span>
                                                    Project @(i + 1)
                                                </button>
                                                <button type="button" class="btn-close remove-project" aria-label="Close"></button>
                                            </div>
                                            <div class="collapsible-content show">
                                                <div class="mb-3">
                                                    <input type="text" class="form-control" asp-for="Projects[i].Name" placeholder="Project name" />
                                                </div>
                                                <div class="mb-3">
                                                    <textarea class="form-control" asp-for="Projects[i].Description" rows="3" placeholder="Project description"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                            <button type="button" id="addProject" class="btn btn-outline-secondary w-100">
                                + Add Project
                            </button>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-danger btn-lg mt-5" id="save-changes">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    body {Share your professional journey to help us find the best opportunities for you


        font-family: 'Roboto', sans-serif;
        background-color: #E0E0E0; /* Light gray background */
    }

    .card {
        background-color: #ffffff; /* White card background */
    }

    .input-group-text {
        background-color: #dc3545; /* Red background for input icons */
        border: none;
    }

    .form-control-lg {
        border-radius: 0.25rem; /* Rounded corners for inputs */
    }

    .btn-danger {
        background-color: #dc3545; /* Red button background */
        border: none;
    }

        .btn-danger:hover {
            background-color: #c82333; /* Darker red on hover */
        }

    .collapsible-content {
        display: none;
    }

        .collapsible-content.show {
            display: block;
        }
</style>


@section Scripts {
    <script src="~/js/profile.js"></script>
    <script>
        function togglePassword(inputId) {
            const confirmPassword = document.getElementById("confirmPassword")
            const passwordInput = document.getElementById(inputId);
            const button = passwordInput.nextElementSibling;
            const icon = button.querySelector('i');

            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                confirmPassword.type = "text";
                icon.classList.replace("bi-eye", "bi-eye-slash");
            } else {
                passwordInput.type = "password";
                confirmPassword.type = "password";
                icon.classList.replace("bi-eye-slash", "bi-eye");
            }
        }
        // Disable the register button after the first click
        document.getElementById("save-changes").addEventListener("click", function (e) {
            this.disabled = true; // Disable the button
            this.innerText = "Saving Changes..."; // Optionally change the button text
            this.form.submit(); // Submit the form
        });
    </script>
    <partial name="_ValidationScriptsPartial" />
}
